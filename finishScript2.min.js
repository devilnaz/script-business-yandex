function createModal(){let e=document.createElement("div");e.setAttribute("id","myCusGround"),e.setAttribute("style",`background-color: rgba(0, 0, 0, 0.3);
position: fixed;
left: 0;
right: 0;
top: 0;
bottom: 0;
overflow-y: auto;
z-index: 9999;`);let t=document.createElement("div");t.setAttribute("style",`
min-height: 100%;
display: flex;
align-items: center;
justify-content: center;
`);let n=document.createElement("div");n.setAttribute("id","myCusContent"),n.setAttribute("style",`
margin: 50px auto;
    background-color: #ffffff;
    max-width: 998px;
    width: 100%;
    padding: 70px 60px 60px 60px;
    border-radius: 10px;
    position: relative;
    z-index: 10;
`),t.append(n),e.append(t),document.querySelector("body").append(e),e.addEventListener("click",e=>{e.target.closest("#myCusContent")||document.querySelector("#myCusGround").remove()})}function createTable(){let e=document.createElement("table");e.setAttribute("id","table5"),e.setAttribute("border","1");let t=`
<thead>
<tr>
<th>Место</th>
<th>Доля трафика</th>
<th>Компания</th>
<th>Категория</th>
<th>Рейтинг</th>
<th>Оценки</th>
<th>Отзывы</th>
<th>Реклама</th>
<th>Актуальность информации</th>
<th>Акции</th>
<th>Фото</th>
<th>Товары и услуги</th>
</tr>
</thead>
`;e.insertAdjacentHTML("afterbegin",t);let n=document.createElement("tbody"),a=document.querySelectorAll(".company-competitors-table__container [id].competitors-table-row");a.forEach(e=>{let t=document.createElement("tr"),a=document.createElement("td"),l=document.createElement("td"),r=document.createElement("td"),d=document.createElement("td"),p=document.createElement("td"),o=document.createElement("td"),c=document.createElement("td"),i=document.createElement("td"),s=document.createElement("td"),u=document.createElement("td"),m=document.createElement("td"),h=document.createElement("td"),y=e.querySelector('[data-name="place"]').textContent;a.textContent=y;let $=e.querySelector(".competitors-data-cell__percentage").textContent;l.textContent=$;let b=e.querySelectorAll(".competitors-data-cell__company-description .truncate__text"),x=b[0].querySelector("a").textContent,E=b[1].textContent;r.append(x),d.append(E);let g=e.querySelectorAll('[data-name="rating"] .label_level_text');2===g.length&&p.append("0"),g.forEach((e,t)=>{let n=e.textContent;console.log(n),n.includes("отзыв")?(n=n.includes("Нет отзывов")?"0":n.split(" ")[0],c.append(n)):n.includes("оцен")?(n=n.includes("Нет оценок")?"0":n.split(" ")[0],o.append(n)):p.append(n)});let f=e.querySelector(".competitors-data-cell__status .competitors-data-cell__advert-status-icon"),C=f.getAttribute("title"),A;A=C.includes("Отсутствует рекламное продвижение на Картах")?"Не продвигают":"Продвигают",i.append(A);let S=e.querySelector(".competitors-data-cell__status .competitors-data-cell__verified-status-icon"),v=S.getAttribute("title"),q;q=v.includes("Владелец давно не обновлял информацию о компании")?"Не обновляют":"Обновляют",s.append(q);let _=e.querySelectorAll('[data-name="profile"] .label_level_text');_.forEach((e,t)=>{let n=e.textContent;0===t?(n=n.includes("Нет акций")?"0":n.split(" ")[0],u.append(n)):1===t?(n=n.includes("Нет фото")?"0":n.split(" ")[0],m.append(n)):2===t&&(n=n.includes("Нет товаров и услуг")?"0":n.split(" ")[0],h.append(n))}),t.append(a),t.append(l),t.append(r),t.append(d),t.append(p),t.append(o),t.append(c),t.append(i),t.append(s),t.append(u),t.append(m),t.append(h),n.append(t)}),e.append(n),document.querySelector("#myCusContent").append(e)}function createBtn(){let e=document.createElement("button");e.textContent="Скопировать данные",e.setAttribute("style",`
  padding: 8px;
    font-size: 16px;
  `);let t=document.createElement("div");t.setAttribute("style",`
  text-align: center;
    margin-bottom: 32px;
  `),t.append(e),document.querySelector("#myCusContent").prepend(t),e.addEventListener("click",e=>{e.preventDefault();let t=new Range,n=document.querySelector("#table5");t.setStartBefore(n),t.setEndAfter(n),console.log("range: ",t),document.getSelection().removeAllRanges(),document.getSelection().addRange(t),document.execCommand("copy")})}createModal(),createTable(),createBtn();