function createModal(){let e=document.createElement("div");e.setAttribute("id","myCusGround"),e.setAttribute("style",`background-color: rgba(0, 0, 0, 0.3);
position: fixed;
left: 0;
right: 0;
top: 0;
bottom: 0;
overflow-y: auto;
z-index: 9999;`);let t=document.createElement("div");t.setAttribute("style",`
min-height: 100%;
display: flex;
align-items: center;
justify-content: center;
`);let n=document.createElement("div");n.setAttribute("id","myCusContent"),n.setAttribute("style",`
margin: 50px auto;
    background-color: #ffffff;
    max-width: 782px;
    width: 100%;
    padding: 70px 60px 60px 60px;
    border-radius: 10px;
    position: relative;
    z-index: 10;
`),t.append(n),e.append(t),document.querySelector("body").append(e),e.addEventListener("click",e=>{e.target.closest("#myCusContent")||document.querySelector("#myCusGround").remove()})}function createTable(){let e=document.createElement("table");e.setAttribute("id","table5"),e.setAttribute("border","1");let t=`
<thead>
<tr>
<th>Место</th>
<th>Доля трафика</th>
<th>Компания и категория бизнеса</th>
<th>Рейтинг в Яндекс Картах</th>
<th>Реклама и актуальность информации</th>
<th>Наполнение профиля</th>
</tr>
</thead>
`;e.insertAdjacentHTML("afterbegin",t);let n=document.createElement("tbody");document.querySelectorAll(".company-competitors-table__container [id].competitors-table-row").forEach(e=>{let t=document.createElement("tr"),r=document.createElement("td"),a=document.createElement("td"),l=document.createElement("td"),o=document.createElement("td"),i=document.createElement("td"),c=document.createElement("td"),d=e.querySelector('[data-name="place"]').textContent;r.textContent=d;let p=e.querySelector(".competitors-data-cell__percentage").textContent;a.textContent=p;let s=e.querySelectorAll(".competitors-data-cell__company-description .truncate__text"),u=s[0].querySelector("a").textContent,m=s[1].textContent;l.innerHTML=u+"<br>"+m+"<br>";e.querySelectorAll('[data-name="rating"] .label_level_text').forEach((e,t)=>{let n=e.textContent;o.innerHTML=o.innerHTML+n+"<br>"});let b;b=e.querySelector(".competitors-data-cell__status .competitors-data-cell__advert-status-icon").getAttribute("title").includes("Отсутствует рекламное продвижение на Картах")?"Не продвигают":"Продвигают",i.innerHTML=i.innerHTML+b+"<br>";let y;y=e.querySelector(".competitors-data-cell__status .competitors-data-cell__verified-status-icon").getAttribute("title").includes("Владелец давно не обновлял информацию о компании")?"Не обновляют":"Обновляют",i.innerHTML=i.innerHTML+y+"<br>";e.querySelectorAll('[data-name="profile"] .label_level_text').forEach((e,t)=>{let n=e.textContent;c.innerHTML=c.innerHTML+n+"<br>"}),t.append(r),t.append(a),t.append(l),t.append(o),t.append(i),t.append(c),n.append(t)}),e.append(n),document.querySelector("#myCusContent").append(e)}function createBtn(){let e=document.createElement("button");e.textContent="Скопировать данные",e.setAttribute("style",`
  padding: 8px;
    font-size: 16px;
  `);let t=document.createElement("div");t.setAttribute("style",`
  text-align: center;
    margin-bottom: 32px;
  `),t.append(e),document.querySelector("#myCusContent").prepend(t),e.addEventListener("click",e=>{e.preventDefault();let t=new Range,n=document.querySelector("#table5");t.setStartBefore(n),t.setEndAfter(n),console.log("range: ",t),document.getSelection().removeAllRanges(),document.getSelection().addRange(t),document.execCommand("copy")})}createModal(),createTable(),createBtn();